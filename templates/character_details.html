<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ character.name }} - Solo Leveling Arise</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/characters.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/character_details.css') }}">
</head>
<body 
    class="{% if character.background_image %}background-image{% endif %}"
    style="{% if character.background_image %}background-image: url('{{ url_for('static', filename=character.background_image) }}');{% endif %}"
>
    {% include 'navbar.html' %}

    <!-- Conteneur principal divisé en deux colonnes -->
    <div class="layout">
        <!-- Colonne pour l'image -->
        <div class="image-column">
            <div class="character-image">
                <img src="{{ url_for('static', filename=character.image) }}" alt="{{ character.name }}">
            </div>
        </div>

        <!-- Colonne pour le contenu principal -->
        <div class="content-column">
            <div class="container">
                <h1>{{ character.name }}</h1>
                <p style="text-align: center; color: #ffcc00; font-weight: bold;" hidden>
                    Type: {{ character.type }}
                </p>

                <!-- Image du personnage (affichée sous le type sur téléphone) -->
                <div class="character-image">
                    <img src="{{ url_for('static', filename=character.image) }}" alt="{{ character.name }}">
                </div>

                <!-- Conteneur pour les onglets et le contenu -->
                <div class="character-info">
                    <div class="tabs-and-content">
                        <!-- Système d'onglets -->
                        <div class="tabs">
                            <div class="tab active" data-tab="description">Description</div>
                            <div class="tab" data-tab="passives">Passifs</div>
                            <div class="tab" data-tab="skills">Skills</div>
                            <div class="tab" data-tab="artefacts">Artefacts</div>
                        </div>

                        <!-- Contenu des onglets -->
                        <div id="description" class="tab-content active">
                            <h2>Description</h2>
                            <p>{{ character.description }}</p>

                            {% if character.weapon and character.weapon|length > 0 %}
                                <h3>Arme</h3>
                                <div class="weapon">
                                    {% for weapon in character.weapon %}
                                        <div>
                                            <img src="{{ url_for('static', filename=weapon.image) }}" alt="{{ weapon.name }}">
                                        </div>
                                        <div class="weapon-stats">
                                            <strong>{{ weapon.name }}</strong>
                                            <p>{{ weapon.stats|safe }}</p>
                                        </div>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <p>Aucune arme disponible pour ce personnage.</p>
                            {% endif %}

                            {% if character.evolutions and character.evolutions|length > 0 %}
                                <h3>Évolutions</h3>
                                <div class="evolutions">
                                    <ul>
                                        {% for evolution in character.evolutions %}
                                            {% if evolution.range %}
                                                <!-- Afficher les évolutions groupées (A06-A10) -->
                                                <li>
                                                    <img src="{{ url_for('static', filename='images/Advancement/' + evolution.id + '.webp') }}" 
                                                         alt="{{ evolution.id }}" 
                                                         class="evolution-image evolution-range">
                                                    <span>{{ evolution.description|safe }}</span>
                                                </li>
                                            {% else %}
                                                <!-- Afficher les évolutions individuelles (A01 à A05) -->
                                                <li>
                                                    <img src="{{ url_for('static', filename='images/Advancement/' + evolution.id + '.webp') }}" 
                                                         alt="{{ evolution.id }}" 
                                                         class="evolution-image">
                                                    <span>{{ evolution.description|safe }}</span>
                                                </li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                </div>
                            {% else %}
                                <p>Aucune évolution disponible pour ce personnage.</p>
                            {% endif %}
                        </div>
                        <div id="passives" class="tab-content">
                            <h2>Passifs</h2>
                            {% if character.passives and character.passives|length > 0 %}
                                {% for passive in character.passives %}
                                    <div class="passive {% if passive.principal == 'True' %}principal{% endif %}">
                                        {% if passive.image %}
                                            <img src="{{ url_for('static', filename=passive.image) }}" alt="{{ passive.name or 'Passive Image' }}">
                                        {% endif %}
                                        <div>
                                            {% if passive.name %}
                                                <strong>{{ passive.name }}</strong><br>
                                            {% endif %}
                                            <p>{{ passive.description|safe }}</p>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <p>Informations sur les passifs du personnage.</p>
                            {% endif %}
                        </div>
                        <div id="skills" class="tab-content">
                            <h2>Skills</h2>
                            {% if character.skills and character.skills|length > 0 %}
                                {% for skill in character.skills %}
                                    <div class="skill {% if skill.principal == 'True' %}principal{% endif %}">
                                        {% if skill.image %}
                                            <img src="{{ url_for('static', filename=skill.image) }}" alt="{{ skill.name or 'Skill Image' }}">
                                        {% endif %}
                                        <div>
                                            {% if skill.name %}
                                                <strong>{{ skill.name }}</strong><br>
                                            {% endif %}
                                            <p>{{ skill.description|safe }}</p>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% else %}
                                <p>Informations sur les skills du personnage.</p>
                            {% endif %}
                        </div>
                        <div id="artefacts" class="tab-content">
                            <!-- Affichage des statistiques à focus -->
                            {% if character.focus_stats and character.focus_stats|length > 0 %}
                            <div class="focus-stats">
                                <h3 hidden>Stats à Focus</h3>
                                <ul class="focus-stats-list">
                                    {% for stat in character.focus_stats %}
                                        <li>{{ stat }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                            {% endif %}
                            <h2>Artefacts</h2>

                            <!-- Liste des artefacts -->
                            {% if character.artefacts and character.artefacts|length > 0 %}
                                <div class="artefacts-container">
                                    <!-- Colonne gauche -->
                                    <div class="artefacts-column">
                                        {% for artefact in character.artefacts[:4] %}
                                            <div class="artefact-item" data-set="{{ artefact.set }}">
                                                <div>
                                                    <!-- Appliquer les événements sur l'image uniquement -->
                                                    <img src="{{ url_for('static', filename=artefact.image) }}" 
                                                         alt="{{ artefact.name }}" 
                                                         class="artefact-image"
                                                         onmouseover="showSetEffects('{{ artefact.set }}', event)"
                                                         onmouseout="hideSetEffects()">
                                                    <div>
                                                        <!-- Statistique principale -->
                                                        <div class="stat-main">
                                                            <div class="stat-container">
                                                                <span>{{ artefact.main_stat.name }}</span>
                                                                <img src="{{ url_for('static', filename='images/Stats_Principale.png') }}" alt="Statistique Principale">
                                                            </div>
                                                        </div>

                                                        <!-- Statistiques secondaires -->
                                                        <div class="stat-secondary-container">
                                                            {% for stat in artefact.secondary_stats %}
                                                                <div class="stat-secondary">
                                                                    <div class="stat-container">
                                                                        <span>{{ stat.name }}</span>
                                                                        <img src="{{ url_for('static', filename='images/Stats_Secondaire.png') }}" alt="Statistique Secondaire">
                                                                    </div>
                                                                </div>
                                                            {% endfor %}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>

                                    <!-- Colonne droite -->
                                    <div class="artefacts-column">
                                        {% for artefact in character.artefacts[4:] %}
                                            <div class="artefact-item" data-set="{{ artefact.set }}">
                                                <div>
                                                    <!-- Appliquer les événements sur l'image uniquement -->
                                                    <img src="{{ url_for('static', filename=artefact.image) }}" 
                                                         alt="{{ artefact.name }}" 
                                                         class="artefact-image"
                                                         onmouseover="showSetEffects('{{ artefact.set }}', event)"
                                                         onmouseout="hideSetEffects()">
                                                    <div>
                                                        <!-- Statistique principale -->
                                                        <div class="stat-main">
                                                            <div class="stat-container">
                                                                <span>{{ artefact.main_stat.name }}</span>
                                                                <img src="{{ url_for('static', filename='images/Stats_Principale.png') }}" alt="Statistique Principale">
                                                            </div>
                                                        </div>

                                                        <!-- Statistiques secondaires -->
                                                        <div class="stat-secondary-container">
                                                            {% for stat in artefact.secondary_stats %}
                                                                <div class="stat-secondary">
                                                                    <div class="stat-container">
                                                                        <span>{{ stat.name }}</span>
                                                                        <img src="{{ url_for('static', filename='images/Stats_Secondaire.png') }}" alt="Statistique Secondaire">
                                                                    </div>
                                                                </div>
                                                            {% endfor %}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% else %}
                                <p>Informations sur les artefacts du personnage.</p>
                            {% endif %}

                            <!-- Conteneur pour afficher les effets de panoplie -->
                            <div id="set-effects" style="display: none; position: absolute; background-color: #1e1e1e; color: #ffcc00; padding: 10px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); z-index: 1000;">
                                <h3 style="margin: 0; font-size: 14px;">Nom de la Panoplie</h3>
                                <ul id="set-effects-list" style="margin: 5px 0 0 0; padding: 0; list-style: none; font-size: 12px;"></ul>
                            </div>

                            <!-- Section des noyaux -->
                            {% if character.cores and character.cores|length > 0 %}
                                <div class="cores-section">
                                    <h2>Noyaux</h2>
                                    <div class="cores-container" style="display: flex; gap: 5px; justify-content: center;">
                                        {% for core in character.cores %}
                                            <div class="core-item" style="text-align: center;">
                                                <img src="{{ url_for('static', filename=core.image) }}" alt="{{ core.name }}" class="core-image">
                                                
                                                <div class="stats">
                                                    <!-- Statistique principale -->
                                                    <div class="stat-main">
                                                        <div class="stat-container">
                                                        <span>{{ core.main_stat.name }}</span>
                                                            <img src="{{ url_for('static', filename='images/Stats_Principale.png') }}" alt="Statistique Principale">
                                                        </div>
                                                    </div>

                                                    <!-- Statistique secondaire -->
                                                    <div class="stat-secondary">
                                                        <div class="stat-container">
                                                            <span>{{ core.secondary_stat.name }}</span>
                                                            <img src="{{ url_for('static', filename='images/Stats_Secondaire.png') }}" alt="Statistique Secondaire">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script id="activeSetEffectsData" type="application/json">
        {{ character.active_set_effects|tojson }}
    </script>
    <script src="{{ url_for('static', filename='js/character_details.js') }}"></script>
</body>
</html>
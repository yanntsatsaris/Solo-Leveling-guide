<div id="skills" class="tab-content">
    <h2>Skills</h2>
    {% if character.alias == "SJW" %}
        {% if session.username and session.rights and ('Admin' in session.rights or 'SuperAdmin' in session.rights) %}
            <button id="add-sjw-skill-btn" class="admin-btn">
                Ajouter une compétence
            </button>
            {% include 'partials/add_sjw_skill_modal.html' %}
        {% endif %}
        <div class="sjw-inner-tabs">
            <div class="sjw-inner-tab-btns">
                <div class="sjw-inner-tab-btn active" data-inner-tab="Skills">Skills</div>
                <div class="sjw-inner-tab-btn" data-inner-tab="QTE">QTE</div>
                <div class="sjw-inner-tab-btn" data-inner-tab="Ultime">Ultime</div>
            </div>
            <div class="sjw-inner-tab-contents">
                
                {% for tab in ['Skills', 'QTE', 'Ultime'] %}
                <div class="sjw-inner-tab-content{% if loop.first %} active{% endif %}" id="sjw-inner-tab-{{ tab }}">
                    
                    <div class="sjw-skill-images">
                        {% set skills = character.skills | selectattr('type', 'equalto', tab) | list %}
                        {% for skill in skills %}
                            <div class="sjw-skill-block">
                                {% if skill.image %}
                                    <img src="{{ url_for('static', filename=skill.image) }}" alt="Skill Image" style="max-width:120px; margin:8px;">
                                {% endif %}
                                {% if skill.gems %}
                                    <div class="sjw-gems-row">
                                        {% for gem in skill.gems %}
                                            {% if gem.image %}
                                                <img src="{{ url_for('static', filename=gem.image) }}" alt="Gem Image" style="max-width:48px; margin:4px;">
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                    {% if skills|length == 0 %}
                        <p>Aucune compétence dans cette catégorie.</p>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        <script>
        document.addEventListener("DOMContentLoaded", function() {
            const innerTabBtns = document.querySelectorAll('.sjw-inner-tab-btn');
            const innerTabContents = document.querySelectorAll('.sjw-inner-tab-content');
            innerTabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    innerTabBtns.forEach(b => b.classList.remove('active'));
                    innerTabContents.forEach(tc => tc.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById('sjw-inner-tab-' + this.dataset.innerTab).classList.add('active');
                });
            });
        });
        </script>
    {% else %}
        {# Section classique pour les autres personnages #}
        {% if character.skills and character.skills|length > 0 %}
            {% for skill in character.skills %}
                <div class="skill {% if skill.principal %}principal{% endif %}">
                    {% if skill.image %}
                        <img src="{{ url_for('static', filename=skill.image) }}" alt="{{ skill.name or 'Skill Image' }}">
                    {% endif %}
                    <div>
                        {% if skill.name %}
                            <strong>{{ skill.name }}</strong><br>
                        {% endif %}
                        <p>{{ skill.description|safe }}</p>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p>Informations sur les skills du personnage.</p>
        {% endif %}
    {% endif %}
</div>
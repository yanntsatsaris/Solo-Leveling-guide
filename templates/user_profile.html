{% extends 'base.html' %}

{% block title %}Mon compte - {{ user.uid[0].decode() if user.uid and user.uid[0] is not none else '' }}{% endblock %}

{% block head_css %}
    <link rel="stylesheet" href="{{ asset_url_for('static', filename='css/user_profile.css') }}" />
{% endblock %}

{% block content %}
    <div class="user-profile-container">
      <h2>Mon compte : {{ user.uid[0].decode() if user.uid and user.uid[0] is not none else '' }}</h2>
      <form method="POST" id="profile-form" autocomplete="off">
        <label>Email :</label>
        <input type="email" name="email" id="profile_email" value="{{ user.email }}" placeholder="Entrez votre email" required />
        <label>Nouveau mot de passe :</label>
        <input type="password" name="password" id="password" placeholder="Laisser vide pour ne pas changer" />
        <label>Confirmer le mot de passe :</label>
        <input type="password" name="password_confirm" id="password_confirm" placeholder="Répéter le mot de passe" />
        <button type="submit" id="profile-submit">Mettre à jour</button>
        <div id="profile-error" class="form-error"></div>
      </form>

      {% if is_admin and user.uid[0].decode() == session['username'] %}
      <hr />
      <h3>Administration</h3>
      <a href="/admin/panoplie" class="admin-btn">Gérer les panoplies</a>
      <a href="/admin/cores" class="admin-btn">Gérer les noyaux et effets</a>
      {% endif %}

      {% if is_super_admin and user.uid[0].decode() == session['username'] %}
      <hr />
      <h3>Super Administration</h3>
      <a href="{{ url_for('admin.admin_test_emails') }}" class="admin-btn">Tester les E-mails</a>
      {% endif %}
    </div>
{% endblock %}

{% block body_js %}
    <script src="{{ asset_url_for('static', filename='js/user_profile.js') }}"></script>
{% endblock %}
